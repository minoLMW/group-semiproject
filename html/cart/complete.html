<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title></title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
	<link rel="stylesheet" href="/assets/css/common-ui.css">
</head>
<body>
	<div class="complete-section">
		<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1000 750" preserveAspectRatio="xMidYMid slice">  
			<defs>
				<filter id="goo">
				<feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />
				<feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
				<feComposite in="SourceGraphic" in2="goo" operator="atop"/>
				</filter>
			</defs>
			<rect class="bg1" width="100%" height="100%" fill="#7df0b9" stroke="7df0b9" />
			<g class="bg2" stroke="#fff" stroke="#fff" filter='url(#goo)'>
				<path class="bg2_wave" fill="#fff" d="M1458-489c-65.5,44.5-61.5,85.5-71.5,192.5s-19.72,146.7-78,186c-86,58-134,45-175,157.5 s-82.25,142.75-123.25,166.75l0,0c-65.5,44.5-61.75,85.75-71.75,192.75s-19.72,146.7-78,186c-86,58-134,45-175,157.5 s-82,142-123,166H-10V-710h1468V-489z"/>
				<line class="bg2_drip" x1="0" y1="0" x2="0" y2="150" stroke-width="30" stroke-linecap="round"/>
			</g>
			<g class="bg3" fill="#7268e5" stroke="#7268e5" filter='url(#goo)'>
				<path class="bg3_wave" d="M1032.39-602c-20.68,25.45-52.12,40.71-92.42,49.25c-101.5,21.5-259,58-269,216s-106,226-106,226 C524.5-80.5,507.5-74.5,447.42-2.48C426.41,22.7,395.3,38.46,355,47C253.5,68.5,96,105,86,263S-20,489-20,489V-602H1032.39z" />
				<line class="bg3_drip" x1="0" y1="0" x2="0" y2="150" stroke-width="30" stroke-linecap="round"/>
			</g>
			<g class="cone">
				<path class="coneBase" fill="#FFDE7D" d="M213.5,309.5c4,6,39,55,42,60s6,6,9.5,0s37.5-50,40.5-54s1-7-3.5-7s-80.5-6-84.5-6S211.5,306.5,213.5,309.5z"/>
				<g fill="#FF3680" stroke="#FF3680" stroke-linecap="round">
				<line class="qDrip" x1="312" y1="400" x2="312" y2="414" stroke-width="18" />
				<line class="qDrip" x1="320" y1="400" x2="320" y2="407" stroke-width="15" />
				<path d="M351.5,357.5c-1.98-12.85-12-23-14-24c-4-2,0-9-7-15c-3.22-2.76-7-6-9-4s-54,67-54,67c1,23,21,24,25,24 c1.33,0,8.82,0.47,10.5,5.5c4,12,11-3,21-3c5.52,0,0.78-7.81,7.5-11.5C351.5,385.5,353.5,370.5,351.5,357.5z M336.92,375 c-4.42,0.5-8.42-2.5-8.42-7.5s2-9-2-14s-3-13,6-10c3.42,1.14,8.67,8.52,8.83,16.26C341.5,367.5,341.33,374.5,336.92,375z"/>
				</g>
			</g>
			<text class="txt" fill="#ff3880" x="360" y="390">BaskinMinoos</text>
			<text class="txt" fill="#000" x="360" y="430" font-size="28" letter-spacing="3.3">Inspired by Baskin Robbins,</text>
			<text class="txt" fill="#000" x="360" y="470" font-size="28" letter-spacing="3.3">Built by Us</text>
			<rect class="titleHit" x="210" y="300" width="550" height="140" fill="rgba(0,0,0,0)">
		</svg>
		<div class="complete-section__menu">
			<svg xmlns="http://www.w3.org/2000/svg" width="320" height="150" stroke-width="39" stroke-linecap="round">
				<mask id="m1">
					<line class="m mb1" stroke="#fff" x1="20" y1="56" x2="20" y2="120" />
				</mask>
				<mask id="m2">
					<line class="m mb2" stroke="#fff" x1="74" y1="56" x2="74" y2="120" />
				</mask>
				<mask id="m3">
					<line class="m mb3" stroke="#fff" x1="129" y1="56" x2="129" y2="120" />
				</mask>
				<mask id="m4">
					<line class="m mb4" stroke="#fff" x1="185" y1="56" x2="185" y2="120" />
				</mask>
				<mask id="m5">
					<line class="m mb5" stroke="#fff" x1="235" y1="56" x2="235" y2="120" />
				</mask>
				<mask id="m6">
					<line class="m mb6" stroke="#fff" x1="286" y1="56" x2="286" y2="120" />
				</mask>
			</svg>
		</div>

		<div class="swiper buyCardSwiper">
			<div class="swiper-wrapper"></div>
		</div>
	</div>

	<script src="/assets/libs/jquery/jquery-3.6.0.min.js"></script>
	<script src="/assets/libs/anime/lib/anime.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
	<script src="/assets/js/common-ui.js"></script>
	<script>
		let nextBg = '.bg3',
		mainTL = gsap.timeline()
			.fromTo('.cone',    {scale:0, transformOrigin:'75% 65%'},{duration:1, scale:1, ease:'elastic.out(2)'}, 0)
			.to('.cone',        {duration:0.3, rotation:20, yoyo:true, repeat:1, ease:'power3.in'}, 0.5)
			.from('.cone',      {duration:0.7, x:200, ease:'back.inOut(2)'}, 0.5)
			.from('.txt',       {duration:0.5, opacity:0, stagger:0.25, ease:'power1.inOut'}, 0.8)
			.from('.txt',       {duration:0.5, y:'+=50', stagger:0.2, ease:'expo'}, 0.8)
			.from('.m',         {duration:0.8, attr:{y1:70}, stagger:-0.12, ease:'back.out(3)'}, 1.8)
			.from('.bg2',       {duration:0.8, scale:1.2, ease:'back.out(2)'}, 0.4)
			.from('.bg3',       {duration:0.6, scale:1.2, transformOrigin:'110% 110%', ease:'back.out(1.2)'}, 0.5)
			.from('.bg3_wave',  {duration:8, x:-585, y:600, ease:'none', repeat:-1}, 0.3)
			.to('.bg2_wave',    {duration:6, x:-447, y:704, ease:'none', repeat:-1}, 0.3)
			.call(startDrip, ['.bg3_drip', 250, -160, 110], 1.5)
			.call(startDrip, ['.bg2_drip', 830, 300, 50], 1.9)

		function startDrip( drip, xBase, yStart, hStart ){
			gsap.fromTo(drip, {
				x:()=>gsap.utils.random(xBase,xBase+80),
				y:yStart,
				attr:{
				y1:0,
				y2:hStart,
				'stroke-width':()=>gsap.utils.random(35,70)
				}
			}, {
				duration:1.1,
				y:'+=325',
				attr:{
				y1:hStart,
				'stroke-width':'-=10'
				},
				ease:'power2.in',
				repeat:-1,
				repeatRefresh:true
			});
		}

		let coneTL = gsap.timeline({paused:true})
			.to('.qDrip', {duration:(i)=>[2.4,2][i], attr:{y2:'+=16'}, repeat:-1, yoyo:true, ease:'back.inOut(5)'});

		coneTL.play()

		let isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
		if (isSafari) gsap.set('.bg2, .bg3', {attr:{filter:'none'}});

		mainTL.add(() => {
			const hasSlides = document.querySelectorAll('.swiper-wrapper .swiper-slide').length > 0;

			if (hasSlides) {
				document.querySelectorAll('.txt').forEach(el => el.classList.add('dimmed'));
				document.querySelector('.cone')?.classList.add('dimmed');
			}
		}, '+=0.25');

		const data = JSON.parse(localStorage.getItem("purchasedItems") || "[]");
		const swiperWrapper = document.querySelector(".buyCardSwiper .swiper-wrapper");

		data.forEach(item => {
			const slide = document.createElement("div");
			slide.className = "swiper-slide";
			slide.style.backgroundColor = item.bg;
			slide.innerHTML = `
				<img src="${item.img}" alt="${item.text}" />
				<p>${item.text}</p>
			`;
			swiperWrapper.appendChild(slide);
		});

		let swiper = new Swiper(".buyCardSwiper", {
			effect: "cards",
			grabCursor: true,
		});

		anime({
			targets: '.buyCardSwiper',
			translateY: [100, -50+"%"],      // 아래 → 원래 위치
			translateX: [-50+"%", -50+"%"],      // 아래 → 원래 위치
			opacity: [0, 1],           // 서서히 보이기
			easing: 'easeOutElastic',
			duration: 500,
			delay: 2000 // 요소마다 순차적으로 등장
		});

		document.addEventListener('keydown', function(event) {
			if (event.ctrlKey && event.shiftKey && event.key.toLowerCase() === 'x') {
				const swiper = document.querySelector('.buyCardSwiper');

				if (swiper) {
					const isHidden = swiper.style.display === 'none';
					swiper.style.display = isHidden ? 'block' : 'none';

					document.querySelectorAll('.txt').forEach(el => el.classList.toggle('dimmed'));
					document.querySelector('.cone')?.classList.toggle('dimmed');

					console.log(`Swiper ${isHidden ? '표시됨' : '숨겨짐'}, dimmed 토글됨`);
				}
			}
		});


	</script>
</body>
</html>